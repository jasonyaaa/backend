# VocalBorn CI/CD Pipeline èªªæ˜

## ğŸ”„ Workflow æ¶æ§‹

æœ¬å°ˆæ¡ˆæ¡ç”¨åˆ†é›¢å¼ CI/CD æ¶æ§‹ï¼Œå°‡ä¸åŒè·è²¬åˆ†ç‚ºç¨ç«‹çš„ workflow æª”æ¡ˆï¼š

### ğŸ“ Workflow æª”æ¡ˆ

1. **`unit-tests.yml`** - å–®å…ƒæ¸¬è©¦æµç¨‹
2. **`docker-deploy.yml`** - Docker æ§‹å»ºèˆ‡éƒ¨ç½²æµç¨‹
3. **`.code-quality.yml.disabled`** - ç¨‹å¼ç¢¼å“è³ªæª¢æŸ¥ï¼ˆå·²åœç”¨ï¼‰

## ğŸ§ª Unit Tests Workflow (`unit-tests.yml`)

### è§¸ç™¼æ¢ä»¶
- **æ‰€æœ‰åˆ†æ”¯çš„ Push äº‹ä»¶**
- **Pull Request åˆ° main åˆ†æ”¯**
- **æ‰‹å‹•è§¸ç™¼**

### åŸ·è¡Œå…§å®¹
- è¨­å®š Python 3.13 æ¸¬è©¦ç’°å¢ƒ
- å®‰è£å°ˆæ¡ˆä¾è³´é …
- é…ç½®æ¸¬è©¦ç’°å¢ƒè®Šæ•¸
- åŸ·è¡Œå–®å…ƒæ¸¬è©¦ï¼ˆå¿½ç•¥éœ€è¦å¤–éƒ¨æœå‹™çš„æ¸¬è©¦ï¼‰
- ç”Ÿæˆæ¸¬è©¦è¦†è“‹ç‡å ±å‘Š
- ä¸Šå‚³æ¸¬è©¦çµæœä½œç‚º artifacts

## ğŸ³ Docker Deploy Workflow (`docker-deploy.yml`)

### è§¸ç™¼æ¢ä»¶
- **åƒ… main åˆ†æ”¯çš„ Push äº‹ä»¶**
- **æ‰‹å‹•è§¸ç™¼ï¼ˆåƒ…é™ main åˆ†æ”¯ï¼‰**

### åŸ·è¡Œéšæ®µ
1. **æª¢æŸ¥æ¸¬è©¦ç‹€æ…‹**ï¼šç­‰å¾…ä¸¦ç¢ºèª Unit Tests é€šé
2. **Docker æ§‹å»ºèˆ‡æ¨é€**ï¼š
   - å¤šå¹³å°æ˜ åƒæ§‹å»ºï¼ˆlinux/amd64, linux/arm64ï¼‰
   - æ¨é€åˆ° Docker Hub
   - æ™ºèƒ½æ¨™ç±¤ç®¡ç†å’Œå¿«å–å„ªåŒ–

## ğŸ›¡ï¸ å®‰å…¨ä¿è­‰

- **åˆ†é›¢å¼åŸ·è¡Œ**ï¼šæ¸¬è©¦èˆ‡éƒ¨ç½²æµç¨‹å®Œå…¨åˆ†é›¢ï¼Œè·è²¬æ¸…æ™°
- **ä¾è³´æª¢æŸ¥**ï¼šDocker éƒ¨ç½²å¿…é ˆç­‰å¾…æ¸¬è©¦é€šé
- **åˆ†æ”¯ä¿è­·**ï¼šåªæœ‰ main åˆ†æ”¯çš„è®Šæ›´æ‰æœƒè§¸ç™¼ Docker æ¨é€
- **ç’°å¢ƒéš”é›¢**ï¼šæ¸¬è©¦ä½¿ç”¨ç¨ç«‹çš„ SQLite æ¸¬è©¦è³‡æ–™åº«
- **æ™ºèƒ½å¿½ç•¥**ï¼šè·³ééœ€è¦å¤–éƒ¨æœå‹™çš„æ¸¬è©¦ï¼Œç¢ºä¿ CI ç©©å®šæ€§

## ğŸ“Š åŸ·è¡ŒçŸ©é™£

| åˆ†æ”¯é¡å‹ | Unit Tests | Docker Deploy |
|---------|------------|---------------|
| `main` | âœ… | âœ… (æ¸¬è©¦é€šéå¾Œ) |
| `develop` | âœ… | âŒ |
| `feature/*` | âœ… | âŒ |
| `fix/*` | âœ… | âŒ |
| PR to main | âœ… | âŒ |

## ğŸ”§ Workflow ä¾è³´é—œä¿‚

```mermaid
graph TD
    A[Push/PR] --> B[Unit Tests]
    B --> C{Tests Pass?}
    C -->|Yes| D{Is Main Branch?}
    C -->|No| E[âŒ Stop]
    D -->|Yes| F[Docker Deploy]
    D -->|No| G[âœ… Complete]
    F --> H[âœ… Deploy Complete]
```

## ğŸ”§ æœ¬åœ°æ¸¬è©¦

åœ¨æ¨é€å‰ï¼Œå»ºè­°å…ˆåœ¨æœ¬åœ°åŸ·è¡Œæ¸¬è©¦ï¼š

```bash
# åŸ·è¡Œå–®å…ƒæ¸¬è©¦
python -m pytest tests/ -v --disable-warnings \
  --ignore=tests/storage/test_audio_storage_service.py \
  --ignore=tests/therapist/test_therapist_service.py \
  -k "not test_send_email"

```

é€™å€‹è¨­è¨ˆç¢ºä¿äº†æ¯æ¬¡ç¨‹å¼ç¢¼è®Šæ›´éƒ½ç¶“éåš´æ ¼çš„æ¸¬è©¦é©—è­‰ï¼ŒåŒæ™‚åªæœ‰ç¶“éå®Œæ•´æ¸¬è©¦çš„ main åˆ†æ”¯è®Šæ›´æ‰æœƒéƒ¨ç½²åˆ°ç”Ÿç”¢ç’°å¢ƒã€‚